![zksync-logo_upscaled](https://github.com/Oladayo-Ahmod/escrow-contract/assets/57647734/2d905a0b-4434-4763-979b-ad06a14435d1)

# A Step-by-Step Guide to Building a Decentralized Escrow System on zkSync.

This article will delve into the intricate step-by-step process of building a decentralized escrow system that empowers users with secure, 
transparent, and efficient transactions on zkSync, a cutting-edge layer 2 scaling solution for Ethereum.

## Table of Contents:
-  [Introduction](#introduction)
-  [Prerequisites](#prerequisites)
-  [Environment Setup](#environment-setup)
-  [Understanding the Code Structure](#snderstanding-the-code)
   - [Project structure](#project-structure)
-  [Writing the Escrow Contract](#writing-the-escrow-contract)
   - [Register Purchaser](#register-purchaser)
   - [Register Vendor](#register-vendor)
   - [Create Agreement](#create-agreement)
   - [Enter Agreement](#enter-agreement)
   - [Deposit Funds](#deposit-funds)
   - [Release Payment](#release-payment)
   - [Refund Payment](#refund-payment)
-  [Complete Code](#complete-Code)
-  [Compiling Smart Contract](#compiling-smart-contract)
-  [Writing Tests](#writing-tests)
-  [Deploying Smart Contract](#deploying-smart-contract)
-  [Conclusion](#conclusion)

## Introduction

zkSync is a layer 2 scaling solution for Ethereum. It is designed not only to increase the transaction throughput of the Ethereum network by reducing transaction costs and latency but also to fully preserve its foundational values â€“ freedom, self-sovereignty, and decentralization. It employs zero-knowledge proofs to achieve scalability and privacy. One of the greatest features of zkSync is hyperscalability which ensures that as transactional demands escalate, the system seamlessly accommodates them without compromising its robust security measures or incurring additional costs.

## Prerequisites

* Basic understanding of Solidity.
* Visual studio code (VS code) or remix ide.
* Faucet: Follow this guide to obtain zkSync faucet.
* Node js is installed on your machine.

## Environment Setup

zkSync provides easy ways to get started with setting your environment by providing great plugins on Hardhat and Foundry. You can get started by using use one of the two. However, for this tutorial, we will be using hardhat.

Run the below command inside your terminal to create the project with the necessary dependencies.

```bash
npx zksync-cli create demo --template hardhat_solidity
```
You will be prompted to enter your private key for the project. Enter your private or skip to set it later.

![escrow2](https://github.com/Oladayo-Ahmod/escrow-contract/assets/57647734/ece399b0-9fc6-492d-a4f7-4e84ee040119)

Next, you will prompted to select package manager. You can select the most comfortable one for you. However, for this tutorial, we will select npm.

![escrow3](https://github.com/Oladayo-Ahmod/escrow-contract/assets/57647734/879bc94e-a552-4096-a078-8e783d6e9a6d)

After selecting npm or your desired package manager, all the required dependencies will be installed.

## Understanding the Code Structure

### Project structure

ğŸ“ Escrow-contract
â”œâ”€â”€ ğŸ“ contracts
â”‚   â”œâ”€â”€ ğŸ“ erc20
â”‚   â”‚   â””â”€â”€ ERC20Token.sol      
â”‚   â”œâ”€â”€ ğŸ“ nft
â”‚   â”‚   â””â”€â”€ NFTContract.sol    
â”‚   â”œâ”€â”€ ğŸ“ paymasters
â”‚   â”‚   â””â”€â”€ Paymaster.sol       
â”‚   â””â”€â”€ Greeter.sol             
â”‚
â”œâ”€â”€ ğŸ“ deploy
â”‚   â”œâ”€â”€ ğŸ“ erc20
â”‚   â”‚   â””â”€â”€ deployERC20.ts      
â”‚   â”œâ”€â”€ ğŸ“ nft
â”‚   â”‚   â””â”€â”€ deployNFT.ts        
â”‚   â”œâ”€â”€ deploy.ts               
â”‚   â”œâ”€â”€ interact.ts             
â”‚   â””â”€â”€ utils.ts                
â”‚
â”œâ”€â”€ ğŸ“ test
â”‚   â”œâ”€â”€ ğŸ“ erc20
â”‚   â”‚   â””â”€â”€ erc20Token.test.ts 
â”‚   â”œâ”€â”€ ğŸ“ nft
â”‚   â”‚   â””â”€â”€ nftContract.test.ts 
â”‚   â””â”€â”€ greeter.test.ts         
â””â”€

Your folder structure should be similar to the one above. These are all pre-generated by `zksync-cli`.

Next, go to the terminal and navigate into the project directory to delete unrequired files inside the `contract` , `test` and `deploy` folder by running the command below:

```
cd escrow-contract && rm -rf ./contracts/* && rm -rf ./deploy/erc20 && rm -rf ./deploy/nft && rm -rf ./test/*
```
Finally, run npm install to install all the dependencies. If you are using yarn , run yarn install .

## Writing the Escrow Contract

Now that we have installed our project dependencies. Let's begin writing our smart contract.
Inside your `contract` folder, create a new file named Escrow.sol. This file will contain all the Escrow's contract codes.

#### SPDX License Identifier
In solidity, the first thing to declare when writing a smart contract is to declare the `spdx-lisense-identifier` .

```solidity
// SPDX-License-Identifier: MIT
```

#### Solidity Version
Next, let's define the contract pragma solidity version. In our case, 0.8.17.
